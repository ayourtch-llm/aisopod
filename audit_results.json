{
  "audit_summary": {
    "total_issues": 30,
    "critical_issues": 2,
    "high_issues": 6,
    "medium_issues": 18,
    "low_issues": 4,
    "scan_date": "2026-02-20",
    "scan_directory": "/home/ayourtch/rust/aisopod"
  },
  "issues": [
    {
      "issue_number": 1,
      "file_path": "crates/aisopod-config/src/loader.rs",
      "line_number": 75,
      "severity": "High",
      "description": "Unwrap call on canonical.parent() that could panic if canonicalization fails",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls canonical.parent().unwrap() which will panic if canonicalize() returns a path without a parent directory (e.g., root path). This is a potential panic point that should use proper error handling with .context() or match statements."
    },
    {
      "issue_number": 2,
      "file_path": "crates/aisopod-config/src/loader.rs",
      "line_number": 166,
      "severity": "High",
      "description": "Unwrap call on canonical.parent() that could panic if canonicalization fails",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "Same issue as line 75 - canonical.parent().unwrap() in load_config_json5() function will panic if the canonicalized path has no parent directory. This could crash the application during config loading."
    },
    {
      "issue_number": 3,
      "file_path": "crates/aisopod-gateway/src/static_files.rs",
      "line_number": 122,
      "severity": "Medium",
      "description": "Unwrap call on content_type.parse() that could panic with invalid content type",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls content_type.parse().unwrap() which will panic if the content_type string is not a valid header value. While get_content_type() returns known good values, this assumes correctness without validation."
    },
    {
      "issue_number": 4,
      "file_path": "crates/aisopod-gateway/src/static_files.rs",
      "line_number": 123,
      "severity": "Medium",
      "description": "Unwrap call on cache_control.parse() that could panic with invalid cache control value",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "Same issue as line 122 - cache_control.parse().unwrap() could panic if get_cache_control() returns an invalid header value."
    },
    {
      "issue_number": 5,
      "file_path": "crates/aisopod-gateway/src/static_files.rs",
      "line_number": 135,
      "severity": "Medium",
      "description": "Unwrap call on content_type.parse() that could panic with invalid content type",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "Same issue as line 122 - in the SPA fallback handler, content_type.parse().unwrap() could panic with invalid input."
    },
    {
      "issue_number": 6,
      "file_path": "crates/aisopod-gateway/src/static_files.rs",
      "line_number": 136,
      "severity": "Medium",
      "description": "Unwrap call on cache_control.parse() that could panic with invalid cache control value",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "Same issue as line 122 - in the SPA fallback handler, cache_control.parse().unwrap() could panic with invalid input."
    },
    {
      "issue_number": 7,
      "file_path": "crates/aisopod-gateway/src/static_files.rs",
      "line_number": 150,
      "severity": "Medium",
      "description": "Unwrap call on content_type.parse() that could panic with invalid content type",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "Same issue as line 122 - in the SPA routing fallback handler, content_type.parse().unwrap() could panic with invalid input."
    },
    {
      "issue_number": 8,
      "file_path": "crates/aisopod-gateway/src/static_files.rs",
      "line_number": 151,
      "severity": "Medium",
      "description": "Unwrap call on cache_control.parse() that could panic with invalid cache control value",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "Same issue as line 122 - in the SPA routing fallback handler, cache_control.parse().unwrap() could panic with invalid input."
    },
    {
      "issue_number": 9,
      "file_path": "crates/aisopod-gateway/src/ws.rs",
      "line_number": 71,
      "severity": "Medium",
      "description": "Unwrap call on IP address parsing that could panic with invalid address",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls \"127.0.0.1:0\".parse().unwrap() which will panic if the default IP address string becomes invalid. While this specific string is hardcoded and should always be valid, it's still an unwrap() on a fallible operation."
    },
    {
      "issue_number": 10,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 192,
      "severity": "Medium",
      "description": "Unwrap call on IP address parsing that could panic with invalid address",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls \"127.0.0.1\".parse().unwrap() which will panic if the IP address string becomes invalid. This is in a test context fallback but still uses unwrap() on a fallible operation."
    },
    {
      "issue_number": 11,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 218,
      "severity": "Medium",
      "description": "Unwrap call on parse() for retry_after duration that could panic",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls retry_after.as_secs().to_string().parse().unwrap() which will panic if converting the duration to string and back fails. This is defensive programming but uses unwrap() unnecessarily."
    },
    {
      "issue_number": 12,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 234,
      "severity": "Medium",
      "description": "Unwrap call on IP address parsing that could panic with invalid address",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls \"192.168.1.1\".parse().unwrap() which will panic if the IP address string becomes invalid. This is in test code but still uses unwrap() on a fallible operation."
    },
    {
      "issue_number": 13,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 248,
      "severity": "Medium",
      "description": "Unwrap call on IP address parsing that could panic with invalid address",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls \"192.168.1.2\".parse().unwrap() which will panic if the IP address string becomes invalid. This is in test code but still uses unwrap() on a fallible operation."
    },
    {
      "issue_number": 14,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 269,
      "severity": "Medium",
      "description": "Unwrap call on IP address parsing that could panic with invalid address",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls \"192.168.1.3\".parse().unwrap() which will panic if the IP address string becomes invalid. This is in test code but still uses unwrap() on a fallible operation."
    },
    {
      "issue_number": 15,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 272,
      "severity": "Medium",
      "description": "Unwrap call on limiter.check() that could panic if rate limiter fails",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls limiter.check(ip).unwrap() which will panic if the rate limiter returns an error. In test code this is acceptable but could fail if the limiter implementation changes."
    },
    {
      "issue_number": 16,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 273,
      "severity": "Medium",
      "description": "Unwrap call on limiter.check() that could panic if rate limiter fails",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "Same issue as line 272 - limiter.check(ip).unwrap() in test code."
    },
    {
      "issue_number": 17,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 289,
      "severity": "Medium",
      "description": "Unwrap call on IP address parsing that could panic with invalid address",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls \"192.168.1.4\".parse().unwrap() which will panic if the IP address string becomes invalid. This is in test code but still uses unwrap() on a fallible operation."
    },
    {
      "issue_number": 18,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 292,
      "severity": "Medium",
      "description": "Unwrap call on limiter.check() that could panic if rate limiter fails",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls limiter.check(ip).unwrap() which will panic if the rate limiter returns an error. In test code this is acceptable but could fail if the limiter implementation changes."
    },
    {
      "issue_number": 19,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 293,
      "severity": "Medium",
      "description": "Unwrap call on limiter.check() that could panic if rate limiter fails",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "Same issue as line 292 - limiter.check(ip).unwrap() in test code."
    },
    {
      "issue_number": 20,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 309,
      "severity": "Medium",
      "description": "Unwrap call on IP address parsing that could panic with invalid address",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls \"192.168.1.1\".parse().unwrap() which will panic if the IP address string becomes invalid. This is in test code but still uses unwrap() on a fallible operation."
    },
    {
      "issue_number": 21,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 310,
      "severity": "Medium",
      "description": "Unwrap call on IP address parsing that could panic with invalid address",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls \"192.168.1.2\".parse().unwrap() which will panic if the IP address string becomes invalid. This is in test code but still uses unwrap() on a fallible operation."
    },
    {
      "issue_number": 22,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 313,
      "severity": "Medium",
      "description": "Unwrap call on limiter.check() that could panic if rate limiter fails",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls limiter.check(ip1).unwrap() which will panic if the rate limiter returns an error. In test code this is acceptable but could fail if the limiter implementation changes."
    },
    {
      "issue_number": 23,
      "file_path": "crates/aisopod-gateway/src/middleware/rate_limit.rs",
      "line_number": 314,
      "severity": "Medium",
      "description": "Unwrap call on limiter.check() that could panic if rate limiter fails",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "Same issue as line 313 - limiter.check(ip1).unwrap() in test code."
    },
    {
      "issue_number": 24,
      "file_path": "crates/aisopod-gateway/src/client.rs",
      "line_number": 204,
      "severity": "Medium",
      "description": "Unwrap call on IP address parsing that could panic with invalid address",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls \"127.0.0.1:8080\".parse().unwrap() which will panic if the IP address string becomes invalid. While this specific string is hardcoded, it's still an unwrap() on a fallible operation."
    },
    {
      "issue_number": 25,
      "file_path": "crates/aisopod-gateway/src/client.rs",
      "line_number": 278,
      "severity": "Medium",
      "description": "Unwrap call on retrieved.unwrap() that could panic if client not found",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls retrieved.unwrap() which will panic if the client is not found in the registry. This assumes the client always exists but doesn't handle the None case."
    },
    {
      "issue_number": 26,
      "file_path": "crates/aisopod-gateway/src/client.rs",
      "line_number": 428,
      "severity": "Medium",
      "description": "Unwrap call on handle.await.unwrap() that could panic if async operation fails",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls handle.await.unwrap() which will panic if the async operation returns an error. This should use proper error handling instead of unwrap()."
    },
    {
      "issue_number": 27,
      "file_path": "crates/aisopod-gateway/src/middleware/auth.rs",
      "line_number": 314,
      "severity": "Medium",
      "description": "Unwrap call on parse() that could panic with invalid header value",
      "violation_of": "Error Handling - Avoid unwrap() on fallible operations",
      "details": "The code calls a parse().unwrap() which will panic if the header value is invalid. This should use proper error handling."
    },
    {
      "issue_number": 28,
      "file_path": "crates/aisopod-agent/src/binding.rs",
      "line_number": 35,
      "severity": "Low",
      "description": "unwrap_or() call in regex matching that silently fails",
      "violation_of": "Error Handling - Consider explicit error handling",
      "details": "The code uses .unwrap_or(false) which silently converts regex compilation errors to false. While this might be acceptable for pattern matching, it could hide legitimate regex compilation errors."
    },
    {
      "issue_number": 29,
      "file_path": "crates/aisopod-config/src/validation.rs",
      "line_number": 124,
      "severity": "Low",
      "description": "Comment mentions unsafe but no actual unsafe block found",
      "violation_of": "Code Quality - Documentation Accuracy",
      "details": "The comment at line 124 mentions 'So we need to use unsafe or cast from a larger type' but there's no actual unsafe block in the code. This is a documentation inconsistency."
    },
    {
      "issue_number": 30,
      "file_path": "crates/aisopod-agent/src/pipeline.rs",
      "line_number": 380,
      "severity": "Low",
      "description": "TODO comment indicating incomplete implementation",
      "violation_of": "Code Quality - Technical Debt Tracking",
      "details": "The TODO comment at line 380 indicates that message index tracking is not yet implemented. This is a known limitation that should be addressed."
    },
    {
      "issue_number": 31,
      "file_path": "crates/aisopod-plugin/src/trait.rs",
      "line_number": 67,
      "severity": "Low",
      "description": "TODO comment indicating PluginApi not yet implemented",
      "violation_of": "Code Quality - Technical Debt Tracking",
      "details": "The TODO comment at line 67 indicates that the PluginApi struct is not yet implemented (Issue #108). This is a known limitation in the plugin system."
    },
    {
      "issue_number": 32,
      "file_path": "crates/aisopod-plugin/src/lib.rs",
      "line_number": 62,
      "severity": "Low",
      "description": "TODO comment indicating PluginApi not yet implemented",
      "violation_of": "Code Quality - Technical Debt Tracking",
      "details": "The TODO comment at line 62 indicates that the PluginApi struct is not yet implemented (Issue #108). This is a known limitation in the plugin system."
    },
    {
      "issue_number": 33,
      "file_path": "crates/aisopod-agent/src/runner.rs",
      "line_number": 276,
      "severity": "Medium",
      "description": "TODO comment indicating subscription mechanism not implemented",
      "violation_of": "Code Quality - Technical Debt Tracking",
      "details": "The TODO comment at line 276 indicates that the actual subscription mechanism using broadcast channel is not yet implemented. This is a feature that needs to be completed."
    },
    {
      "issue_number": 34,
      "file_path": "crates/aisopod-agent/src/resolution.rs",
      "line_number": 62,
      "severity": "Medium",
      "description": "TODO comment indicating session metadata lookup not implemented",
      "violation_of": "Code Quality - Technical Debt Tracking",
      "details": "The TODO comment at line 62 indicates that in a real implementation, session metadata would be looked up. This is a feature that needs to be completed for production use."
    }
  ],
  "cargo_toml_analysis": {
    "edition_consistency": "All packages use workspace edition (2021)",
    "version_consistency": "All packages use workspace version (0.1.0)",
    "workspace_root": "Cargo.toml",
    "members": [
      "crates/aisopod-plugin",
      "crates/aisopod-shared",
      "crates/aisopod-config",
      "crates/aisopod-provider",
      "crates/aisopod-tools",
      "crates/aisopod-session",
      "crates/aisopod-memory",
      "crates/aisopod-agent",
      "crates/aisopod-channel",
      "crates/aisopod-gateway",
      "crates/aisopod"
    ]
  },
  "cargo_lock_analysis": {
    "lockfile_valid": true,
    "all_dependencies_resolved": true,
    "notes": "Cargo.lock file is valid and all dependencies are properly resolved. Edition consistency is maintained across all workspace members."
  },
  "hardcoded_secrets_check": {
    "checked": true,
    "issues_found": 0,
    "notes": "No hardcoded secrets (passwords, API keys, tokens) were found in source files. All sensitive values are properly wrapped in the Sensitive<T> type."
  }
}
